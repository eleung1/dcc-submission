# ABOUT
# the general section contains variables used throughout templates
# the node_config section defines the nodes of the cluster
# comments starting with '#' are removed before parsing
{
  # GENERAL CONFIG
  # will likely make these lower-case in the future
  "general": {
    # OPEN STACK
    "OS_API_KEY": "<FILL_ME_IN>",
    "OS_USER": "<FILL_ME_IN>",
    "OS_INSTANCE_TYPE": "m1.xlarge",
    "OS_IMAGE": "Ubuntu 12.04 amd64",
    "OS_ENDPOINT": "<FILL_ME_IN>",
    "OS_SSH_KEY_NAME": "<FILL_ME_IN>",
    "OS_SSH_USERNAME": "<FILL_ME_IN>",
    "OS_SSH_PEM_FILE": "<FILL_ME_IN>",
    "OS_TENANT": "<FILL_ME_IN>",
    "OS_NETWORK": "<FILL_ME_IN>"
  },

  # NODE CONFIG
  # type=[master|worker], in the future we may have more types
  # you need 1 master and 0..n workers
  "node_config": [
    # NOTE: the master node is assumed to be called "master" (for now), things will break if named something else
    {
      "name": ["master"],
      "type": "master",
      "floatip": ["<FILL_ME_IN>"],
      # NOTE: you can have multiple scripts but they are cat'd together and run as a single provision step when the box first boots
      "first_pass_scripts": [
        "templates/server_setup_scripts/ubuntu_12.04_minimal_script.sh"
      ], 
      # NOTE: this is an array of arrays, all the scripts in the array in the first cell of the outer array are run across the full cluster, then the second...
      "second_pass_scripts": [
        [ "templates/server_setup_scripts/ubuntu_12.04_master_script.sh" ],
        # NOTE: the master script will be run along with the worker setup scripts (see below) then, finally, our test script for SeqWare that launches various integration tests will run
        [ ],
        [ "master_node.sh" ]
      ]
    },

    {
      "name": ["<FILL_ME_IN>", "<FILL_ME_IN>", "<FILL_ME_IN>"],
      "type": "worker",
      "floatip": ["<FILL_ME_IN>", "<FILL_ME_IN>", "<FILL_ME_IN>"],
      "first_pass_scripts": [
        "templates/server_setup_scripts/ubuntu_12.04_minimal_script.sh"
      ], 
      # NOTE: the first array is empty meaning the master script will run on the master node, then in the next pass the worker scripts will run on the worker nodes, then, in the last pass of provisioning, the master node will run SeqWare integration tests
      "second_pass_scripts": [
        [ ],
        [ "templates/server_setup_scripts/ubuntu_12.04_worker_script.sh" ],
        [ ]
      ]
    }
  ]
}
